<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Generator Togel - 10 Kontrol (B s/d Y)</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      margin: 0;
      padding: 16px;
      background: #f8f9fa;
      color: #212529;
    }
    .container {
      max-width: 100%;
    }
    .back-home {
      text-align: center;
      margin-bottom: 16px;
    }
    .back-home a {
      display: inline-block;
      padding: 8px 16px;
      background-color: #3498db;
      color: white;
      text-decoration: none;
      border-radius: 6px;
      font-size: 14px;
      font-weight: bold;
    }
    .back-home a:hover {
      background-color: #2980b9;
    }
    h1 {
      text-align: center;
      font-size: 1.5em;
      margin: 0 0 20px;
      color: #1a365d;
    }
    .input-section {
      margin-bottom: 16px;
    }
    input {
      width: 100%;
      padding: 12px;
      border: 1px solid #ccc;
      border-radius: 8px;
      font-size: 1.1em;
      text-align: center;
      box-sizing: border-box;
    }
    .buttons {
      display: flex;
      gap: 10px;
      margin-top: 12px;
    }
    .buttons button {
      flex: 1;
      padding: 12px;
      font-size: 1em;
    }
    #generateBtn {
      background: #1a73e8;
    }
    #generateBtn:hover {
      background: #0d5bb8;
    }
    #saveBtn {
      background: #34a853;
    }
    #saveBtn:hover {
      background: #2d8e49;
    }
    .copy-btn {
      margin-top: 6px;
      padding: 6px 10px;
      font-size: 0.9em;
      background: #f1f3f4;
      color: #5f6368;
      border: 1px solid #dadce0;
      border-radius: 4px;
      cursor: pointer;
      width: auto;
    }
    .copy-btn:hover {
      background: #e8eaed;
    }
    .results {
      background: white;
      border-radius: 10px;
      padding: 16px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      margin-top: 16px;
      font-family: monospace;
      font-size: 0.95em;
      line-height: 1.6;
    }
    .section {
      margin-bottom: 16px;
    }
    .section h2 {
      margin: 0 0 10px;
      font-size: 1.2em;
      color: #1a365d;
    }
    .value {
      word-break: break-all;
      padding: 10px;
      background: #f8f9fa;
      border-radius: 6px;
      border: 1px dashed #ddd;
    }
    .freq-1 { color: #107c10; background-color: #e6f4ea; }
    .freq-2 { color: #8b5cf6; background-color: #f0e6ff; }
    .freq-3 { color: #dc2626; background-color: #fee2e2; }
    .freq-4 { color: #0891b2; background-color: #ecfeff; }
    .freq-5 { color: #7c2d12; background-color: #ffefeb; }
    .freq-6 { color: #5d1a9b; background-color: #f3e8ff; }
    .freq-7 { color: #065f46; background-color: #d1fae5; }
    .freq-8 { color: #842f00; background-color: #ffedd5; }
    .freq-9 { color: #115e59; background-color: #ccfbf1; }
    .freq-10 { color: #591c0f; background-color: #fde8e0; }
    .not-caught { color: #c5221f; background-color: #fce8e6; }
    .error, #save-status {
      color: #d93025;
      text-align: center;
      font-weight: bold;
      margin-top: 12px;
      padding: 10px;
      background: #fce8e6;
      border-radius: 6px;
      display: none;
    }
    #save-status.success {
      color: #107c10;
      background: #e6f4ea;
      display: block;
    }
    #save-status.error {
      display: block;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="back-home">
      <a href="index.html">‚Üê Kembali ke Beranda</a>
    </div>

    <h1>üî¢ Generator Togel (B s/d Y)</h1>

    <div class="input-section">
      <input type="text" id="currResult" placeholder="Masukkan Result Sekarang (4D)" maxlength="4" />
    </div>

    <div class="buttons">
      <button id="generateBtn">Generate 2D</button>
      <button id="saveBtn">üíæ Simpan ke Cloud</button>
    </div>

    <div id="error" class="error"></div>
    <div id="save-status"></div>

    <div class="results" id="resultsContainer">
    </div>
  </div>

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>

  <script>
    // ‚îÄ‚îÄ‚îÄ KONFIGURASI FIREBASE (proyek: nomoromosse) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    const firebaseConfig = {
      apiKey: "AIzaSyD5stzd9mu0n58o_QYL5Jt1aXOP9ANQl80",
      authDomain: "sd139lamanda-d7e39.firebaseapp.com",
      databaseURL: "https://sd139lamanda-d7e39-default-rtdb.asia-southeast1.firebasedatabase.app",
      projectId: "sd139lamanda-d7e39",
      storageBucket: "sd139lamanda-d7e39.firebasestorage.app",
      messagingSenderId: "101544011485",
      appId: "1:101544011485:web:74c0fa59d3c4bf74451d34"
    };

    if (!firebase.apps.length) {
      firebase.initializeApp(firebaseConfig);
    }
    const database = firebase.database();

    // ‚îÄ‚îÄ‚îÄ [SEMUA DATA KONTROL B‚ÄìY SAMA SEPERTI ASLI] ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    const KONTROL_B = {
      1: ["1", "2", "6", "7", "8", "9"],
      2: ["0", "2", "3", "7", "8", "9"],
      3: ["0", "1", "3", "4", "8", "9"],
      4: ["0", "1", "2", "4", "5", "9"],
      5: ["0", "1", "2", "3", "5", "6"],
      6: ["1", "2", "3", "4", "6", "7"],
      7: ["2", "3", "4", "5", "7", "8"],
      8: ["3", "4", "5", "6", "8", "9"],
      9: ["0", "4", "5", "6", "7", "9"],
      0: ["1", "2", "3", "4", "5", "6"]
    };

    const KONTROL_C = {
      0: ["3", "4", "5", "6", "8", "9"],
      1: ["0", "2", "3", "4", "6", "9"],
      2: ["1", "2", "3", "5", "6", "8"],
      3: ["0", "1", "2", "3", "4", "9"],
      4: ["1", "2", "3", "6", "8", "9"],
      5: ["0", "1", "2", "3", "4", "5", "9"],
      6: ["0", "2", "3", "5", "6", "9"],
      7: ["0", "1", "2", "3", "8", "9"],
      8: ["2", "3", "4", "6", "7", "9"],
      9: ["1", "2", "3", "4", "5", "6"]
    };

    const KONTROL_D = KONTROL_B;

    const KONTROL_G = {
      0: ["0", "1", "2", "7", "8", "9"],
      1: ["0", "1", "2", "3", "8", "9"],
      2: ["0", "1", "2", "3", "4", "9"],
      3: ["0", "1", "2", "3", "4", "5"],
      4: ["1", "2", "3", "4", "5", "6"],
      5: ["2", "3", "4", "5", "6", "7"],
      6: ["3", "4", "5", "6", "7", "8"],
      7: ["4", "5", "6", "7", "8", "9"],
      8: ["5", "6", "7", "8", "9", "0"],
      9: ["6", "7", "8", "9", "0", "1"]
    };

    const KONTROL_H = {
      0: ["0", "1", "2", "5", "6", "7"],
      1: ["1", "2", "3", "6", "7", "8"],
      2: ["2", "3", "4", "7", "8", "9"],
      3: ["0", "3", "4", "5", "8", "9"],
      4: ["0", "2", "4", "5", "6", "9"],
      5: ["0", "1", "2", "5", "6", "7"],
      6: ["1", "2", "3", "6", "7", "8"],
      7: ["2", "3", "4", "7", "8", "9"],
      8: ["0", "3", "4", "5", "8", "9"],
      9: ["0", "1", "4", "5", "6", "9"]
    };

    const KONTROL_I = {
      0: ["0", "2", "3", "5", "6", "7"],
      1: ["0", "3", "4", "6", "7", "9"],
      2: ["0", "1", "5", "6", "7", "8"],
      3: ["2", "5", "6", "7", "8", "9"],
      4: ["0", "2", "3", "5", "6", "7"],
      5: ["0", "1", "4", "7", "8", "9"],
      6: ["0", "1", "2", "7", "8", "9"],
      7: ["0", "1", "2", "3", "6", "9"],
      8: ["0", "1", "2", "3", "4", "5"],
      9: ["0", "3", "4", "5", "7", "8"]
    };

    const KONTROL_J = {
      0: ["4", "5", "6", "7", "8", "9"],
      1: ["5", "6", "7", "8", "9", "0"],
      2: ["6", "7", "8", "9", "0", "1"],
      3: ["7", "8", "9", "0", "1", "2"],
      4: ["8", "9", "0", "1", "2", "3"],
      5: ["9", "0", "1", "2", "3", "4"],
      6: ["0", "1", "2", "3", "4", "5"],
      7: ["1", "2", "3", "4", "5", "6"],
      8: ["2", "3", "4", "5", "6", "7"],
      9: ["3", "4", "5", "6", "7", "8"]
    };

    const KONTROL_K = {
      0: ["0", "3", "4", "5", "6", "9"],
      1: ["0", "1", "4", "5", "6", "7"],
      2: ["1", "2", "5", "6", "7", "8"],
      3: ["2", "3", "6", "7", "8", "9"],
      4: ["0", "3", "4", "7", "8", "9"],
      5: ["0", "1", "4", "5", "8", "9"],
      6: ["0", "1", "2", "5", "6", "9"],
      7: ["0", "1", "2", "3", "6", "7"],
      8: ["1", "2", "3", "4", "7", "8"],
      9: ["2", "3", "4", "5", "8", "9"]
    };

    const KONTROL_R = {
      0: ["5", "6", "7", "8", "9", "0"],
      1: ["1", "2", "3", "4", "5", "6"],
      2: ["7", "8", "9", "0", "1", "2"],
      3: ["3", "4", "5", "6", "7", "8"],
      4: ["9", "0", "1", "2", "3", "4"],
      5: ["5", "6", "7", "8", "9", "0"],
      6: ["1", "2", "3", "4", "5", "6"],
      7: ["7", "8", "9", "0", "1", "2"],
      8: ["3", "4", "5", "6", "7", "8"],
      9: ["9", "0", "1", "2", "3", "4"]
    };

    const KONTROL_Y = {
      0: ["8", "9", "0", "1", "2", "3"],
      1: ["9", "0", "1", "2", "3", "4"],
      2: ["0", "1", "2", "3", "4", "5"],
      3: ["1", "2", "3", "4", "5", "6"],
      4: ["2", "3", "4", "5", "6", "7"],
      5: ["3", "4", "5", "6", "7", "8"],
      6: ["4", "5", "6", "7", "8", "9"],
      7: ["5", "6", "7", "8", "9", "0"],
      8: ["6", "7", "8", "9", "0", "1"],
      9: ["7", "8", "9", "0", "1", "2"]
    };

    // ‚îÄ‚îÄ‚îÄ FUNGSI BANTUAN ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    function digitalRoot(n) {
      let s = n;
      while (s >= 10) {
        s = String(s).split('').reduce((a, b) => parseInt(a) + parseInt(b), 0);
      }
      return s;
    }

    function getInverseDigits(allowed) {
      const all = ["0","1","2","3","4","5","6","7","8","9"];
      return all.filter(d => !allowed.includes(d));
    }

    function generateAll2DFromDigits(digits) {
      const unique = [...new Set(digits)];
      const combos = [];
      for (const a of unique) {
        for (const b of unique) {
          combos.push(a + b);
        }
      }
      return new Set(combos);
    }

    function getAll2D() {
      return Array.from({length: 100}, (_, i) => i.toString().padStart(2, '0'));
    }

    // ‚îÄ‚îÄ‚îÄ KONTROL FUNGSI ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    function get2DSetFromB(curr) {
      const as = parseInt(curr[0]);
      const ekor = parseInt(curr[3]);
      const dasar = digitalRoot(as + ekor);
      const allowed = KONTROL_B[dasar] || [];
      const inverse = getInverseDigits(allowed);
      return generateAll2DFromDigits(inverse);
    }

    function get2DSetFromC(curr) {
      const kepala = curr[2];
      const allowed = KONTROL_C[kepala] || [];
      const inverse = getInverseDigits(allowed);
      return generateAll2DFromDigits(inverse);
    }

    function get2DSetFromD(curr) {
      const kop = parseInt(curr[1]);
      const kepala = parseInt(curr[2]);
      const dasar = digitalRoot(kop + kepala);
      const allowed = KONTROL_D[dasar] || [];
      const inverse = getInverseDigits(allowed);
      return generateAll2DFromDigits(inverse);
    }

    function get2DSetFromG(curr) {
      const kop = parseInt(curr[1]);
      const kepala = parseInt(curr[2]);
      const dasar = (kop + kepala) % 10;
      const allowed = KONTROL_G[dasar] || [];
      const inverse = getInverseDigits(allowed);
      return generateAll2DFromDigits(inverse);
    }

    function get2DSetFromH(curr) {
      const kepala = curr[2];
      const allowed = KONTROL_H[kepala] || [];
      const inverse = getInverseDigits(allowed);
      return generateAll2DFromDigits(inverse);
    }

    function get2DSetFromI(curr) {
      const ekor = curr[3];
      const allowed = KONTROL_I[ekor] || [];
      const inverse = getInverseDigits(allowed);
      return generateAll2DFromDigits(inverse);
    }

    function get2DSetFromJ(curr) {
      const as = parseInt(curr[0]);
      const ekor = parseInt(curr[3]);
      const dasar = (as + ekor) % 10;
      const allowed = KONTROL_J[dasar] || [];
      const inverse = getInverseDigits(allowed);
      return generateAll2DFromDigits(inverse);
    }

    function get2DSetFromK(curr) {
      const kepala = parseInt(curr[2]);
      const ekor = parseInt(curr[3]);
      const dasar = (kepala + ekor) % 10;
      const allowed = KONTROL_K[dasar] || [];
      const inverse = getInverseDigits(allowed);
      return generateAll2DFromDigits(inverse);
    }

    function get2DSetFromR(curr) {
      const ekor = curr[3];
      const allowed = KONTROL_R[ekor] || [];
      const inverse = getInverseDigits(allowed);
      return generateAll2DFromDigits(inverse);
    }

    function get2DSetFromY(curr) {
      const kop = parseInt(curr[1]);
      const ekor = parseInt(curr[3]);
      const dasar = (kop + ekor) % 10;
      const allowed = KONTROL_Y[dasar] || [];
      const inverse = getInverseDigits(allowed);
      return generateAll2DFromDigits(inverse);
    }

    // ‚îÄ‚îÄ‚îÄ HITUNG SEMUA ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    function calculateAll(curr) {
      const setB = get2DSetFromB(curr);
      const setC = get2DSetFromC(curr);
      const setD = get2DSetFromD(curr);
      const setG = get2DSetFromG(curr);
      const setH = get2DSetFromH(curr);
      const setI = get2DSetFromI(curr);
      const setJ = get2DSetFromJ(curr);
      const setK = get2DSetFromK(curr);
      const setR = get2DSetFromR(curr);
      const setY = get2DSetFromY(curr);

      const all2d = getAll2D();
      const freqMap = {};
      const notCaught = [];

      for (const twoDigit of all2d) {
        let count = 0;
        if (setB.has(twoDigit)) count++;
        if (setC.has(twoDigit)) count++;
        if (setD.has(twoDigit)) count++;
        if (setG.has(twoDigit)) count++;
        if (setH.has(twoDigit)) count++;
        if (setI.has(twoDigit)) count++;
        if (setJ.has(twoDigit)) count++;
        if (setK.has(twoDigit)) count++;
        if (setR.has(twoDigit)) count++;
        if (setY.has(twoDigit)) count++;

        if (count > 0) {
          if (!freqMap[count]) freqMap[count] = [];
          freqMap[count].push(twoDigit);
        } else {
          notCaught.push(twoDigit);
        }
      }

      return { freqMap, notCaught, input: curr };
    }

    // ‚îÄ‚îÄ‚îÄ SALIN TEKS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    function salinTeks(teks, btn) {
      if (!teks) return;
      if (navigator.clipboard) {
        navigator.clipboard.writeText(teks).then(() => {
          const original = btn.textContent;
          btn.textContent = '‚úÖ Tersalin!';
          setTimeout(() => btn.textContent = original, 1500);
        });
      } else {
        const textarea = document.createElement('textarea');
        textarea.value = teks;
        document.body.appendChild(textarea);
        textarea.select();
        document.execCommand('copy');
        document.body.removeChild(textarea);
        btn.textContent = '‚úÖ';
        setTimeout(() => btn.textContent = 'üìã Salin', 1000);
      }
    }

    // ‚îÄ‚îÄ‚îÄ TAMPILKAN ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    function displayResults(freqMap, notCaught, input) {
      const container = document.getElementById('resultsContainer');
      container.innerHTML = '';

      // Simpan hasil untuk keperluan simpan/salin
      window.lastResult = { freqMap, notCaught, input };

      // Tampilkan "Tidak Terjaring"
      const notCaughtText = notCaught.length > 0 ? notCaught.join('*') : '--';
      const notCaughtSection = document.createElement('div');
      notCaughtSection.className = 'section';
      notCaughtSection.innerHTML = `
        <h2>‚ùå 2D Tidak Terjaring</h2>
        <div class="value not-caught">${notCaughtText}</div>
        <button class="copy-btn" onclick="salinTeks('${notCaughtText}', this)">üìã Salin</button>
      `;
      container.appendChild(notCaughtSection);

      if (Object.keys(freqMap).length === 0) {
        container.innerHTML += '<div class="section"><h2>üéØ Tidak ada 2D yang terjaring</h2></div>';
        return;
      }

      const sortedFreq = Object.keys(freqMap).map(Number).sort((a, b) => a - b);
      for (const freq of sortedFreq) {
        const list = freqMap[freq].sort();
        const text = list.join('*');
        let className = 'freq-1';
        if (freq === 2) className = 'freq-2';
        else if (freq === 3) className = 'freq-3';
        else if (freq === 4) className = 'freq-4';
        else if (freq === 5) className = 'freq-5';
        else if (freq === 6) className = 'freq-6';
        else if (freq === 7) className = 'freq-7';
        else if (freq === 8) className = 'freq-8';
        else if (freq === 9) className = 'freq-9';
        else if (freq === 10) className = 'freq-10';

        const section = document.createElement('div');
        section.className = 'section';
        section.innerHTML = `
          <h2>üéØ Terjaring ${freq}x</h2>
          <div class="value ${className}">${text}</div>
          <button class="copy-btn" onclick="salinTeks('${text}', this)">üìã Salin</button>
        `;
        container.appendChild(section);
      }
    }

    // ‚îÄ‚îÄ‚îÄ SIMPAN KE FIREBASE ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    function simpanKeFirebase() {
      const statusEl = document.getElementById('save-status');
      statusEl.className = 'error';
      statusEl.style.display = 'none';

      if (!window.lastResult) {
        statusEl.textContent = '‚ö†Ô∏è Belum ada hasil untuk disimpan.';
        statusEl.style.display = 'block';
        return;
      }

      const { input, notCaught, freqMap } = window.lastResult;
      const sortedFreq = Object.keys(freqMap).map(Number).sort((a, b) => a - b);
      const sections = {};

      sections.notCaught = notCaught.length > 0 ? notCaught.join('*') : '--';

      sortedFreq.forEach(freq => {
        sections[`terjaring_${freq}x`] = freqMap[freq].sort().join('*');
      });

      const data = {
        input: input,
        hasil: sections,
        timestamp: firebase.database.ServerValue.TIMESTAMP,
        fitur: "fitur10_andhi"
      };

      database.ref('fitur10').push(data)
        .then(() => {
          statusEl.textContent = '‚úÖ Berhasil disimpan ke cloud!';
          statusEl.className = 'success';
          statusEl.style.display = 'block';
        })
        .catch(err => {
          statusEl.textContent = '‚ùå Gagal simpan: ' + err.message;
          statusEl.className = 'error';
          statusEl.style.display = 'block';
        });
    }

    // ‚îÄ‚îÄ‚îÄ EKSEKUSI ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    document.getElementById('generateBtn').addEventListener('click', () => {
      const input = document.getElementById('currResult').value.trim();
      const errorEl = document.getElementById('error');
      errorEl.style.display = 'none';

      if (!/^\d{4}$/.test(input)) {
        errorEl.textContent = '‚ö†Ô∏è Masukkan 4 digit angka';
        errorEl.style.display = 'block';
        document.getElementById('resultsContainer').innerHTML = '';
        delete window.lastResult;
        return;
      }

      try {
        const result = calculateAll(input);
        displayResults(result.freqMap, result.notCaught, input);
      } catch (e) {
        errorEl.textContent = 'Terjadi kesalahan saat memproses.';
        errorEl.style.display = 'block';
        delete window.lastResult;
      }
    });

    document.getElementById('saveBtn').addEventListener('click', simpanKeFirebase);

    document.getElementById('currResult').addEventListener('keypress', (e) => {
      if (e.key === 'Enter') {
        document.getElementById('generateBtn').click();
      }
    });
  </script>
</body>
</html>
